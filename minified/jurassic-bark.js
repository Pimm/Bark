'use strict';(function(m){function g(){}function f(a,b,c){this.b=null===(this.g=b)?this.c=a:h(this.c=a,b);this.e=c}function k(a){delete a.c;delete a.b;delete a.g;a.destroy=g}function l(a){this.e=a}function i(a,b){this.f=a;this.h=b}function e(a){this.a={};this.d=void 0===a?this:a}var j={},h=function(){return g.bind?function(a,b){return a.bind(b)}:function(a,b){return function(){a.apply(b,arguments)}}}();f.prototype.add=function(a,b,c){return new i(this,this.e.add(a,b,c))};var n=function(){return[].lastIndexOf?
function(a,b){return a.lastIndexOf(b)}:function(a,b){for(var c=a.length;-1!=c;c--)if(a[c]===b)return c;return-1}}();f.prototype.destroy=function(){k(this.i.splice(n(this.i,this),1)[0])};f.prototype.destroyOnUse=function(){var a=this,b=this.b;this.b=function(){a.destroy();b.call(this)};return a};l.prototype={add:function(a,b,c){return this.e.add(a,b,c)},destroy:g,destroyOnUse:function(){return this}};i.prototype={add:function(a,b,c){return new i(this.f,this.h.add(a,b,c))},destroy:function(){this.f.destroy();
this.h.destroy()},destroyOnUse:function(){this.f.destroyOnUse();this.h.destroyOnUse();return this}};e.prototype.add=function(a,b,c){if(null===b)return this.k?this.k:this.k=new l(this);void 0===c&&(c=this===this.d?null:this.d);var d=j[a]?this.a[a="event-type-"+a]:this.a[a];if(d){for(var e=0;e<d.length;e++)if(d[e].c==b&&(a=d[e],a.g===c))return a;d.push(a=new f(b,c,this))}else d=this.a[a]=[a=new f(b,c,this)];a.i=d;return a};e.prototype.emit=function(a){var b=j[a]?this.a[a="event-type-"+a]:this.a[a];
if(b)if(1==b.length)2>arguments.length?b[0].b.call(this):b[0].b.apply(this,b.slice.call(arguments,1));else if(b.length)if(b=b.slice(0),2>arguments.length)for(var c=0;c<b.length;c++)b[c].b.call(this);else for(var d=b.slice.call(arguments,1),c=0;c<b.length;c++)b[c].b.apply(this,d);return this.j?this.j:this.j={emit:h(this.emit,this)}};e.prototype.remove=function(a,b,c){void 0===c&&(c=this==this.d?null:this.d);if(a=j[a]?this.a["event-type-"+a]:this.a[a])for(var d=0;d<a.length;d++)if(a[d].c==b&&a[d].g===
c){k(a.splice(d,1)[0]);break}return this.l?this.l:this.l={remove:h(this.remove,this)}};m.EventEmitter=e})(this);
