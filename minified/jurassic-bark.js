'use strict';(function(o){function k(){}function p(a,b){return function(c,d,e){return new l(a,(this==a?b:this).add(c,d,e))}}function i(a,b,c){this.g=void 0===(this.f=b)?this.c=a:q(this.c=a,b);this.add=p(this,this.e=c)}function r(a){delete a.c;delete a.g;delete a.f;a.destroy=k}function m(a){this.e=a}function l(a,b){this.l=a;this.m=b}function j(a){this.a=void 0===a?this:a;this.d={}}function t(a){var b={emit:function(){var c=this==b?a:this;return c.emit.apply(c,arguments)}};return b}function s(a){var b;
return b={remove:function(c,d,e){return(this==b?a:this).remove(c,d,e)}}}var g=!1,n={},q=function(){return k.bind?function(a,b){return a.bind(b)}:function(a,b){return function(){a.apply(b,arguments)}}}(),u=function(){return!0==g||[].lastIndexOf?function(a,b){return a.lastIndexOf(b)}:function(a,b){for(var c=a.length;-1!=c;c--)if(a[c]===b)return c;return-1}}();i.prototype.destroy=function(){r(this.n.splice(u(this.n,this),1)[0])};i.prototype.destroyOnUse=function(){var a=this,b=this.g;this.g=function(){a.destroy();
b.call(this)};return a};m.prototype={add:function(a,b,c){return this.e.add(a,b,c)},destroy:k,destroyOnUse:function(){return this}};l.prototype={add:function(a,b,c){return new l(this.l,this.m.add(a,b,c))},destroy:function(){this.l.destroy();this.m.destroy()},destroyOnUse:function(){this.l.destroyOnUse();this.m.destroyOnUse();return this}};j.prototype.add=function(a,b,c){if(null===b)return this.i?this.i:this.i=new m(this);var d=n[a]?this.d[a="e-"+a]:this.d[a],e;if(d){for(a=0;a<d.length;a++)if(d[a].c==
b&&(e=d[a]).f===c)return e;d.push(e=new i(b,c,this))}else d=this.d[a]=[e=new i(b,c,this)];e.n=d;return e};j.prototype.emit=function(a,b){var c=n[a]?this.d[a="e-"+a]:this.d[a];if(c){var d=1==arguments.length?[]:c.slice.call(arguments,1);if(1==c.length)c[0].g.apply(this.a,d);else if(c.length)for(var c=c.slice(0),e=0;e<c.length;e++)c[e].g.apply(this.a,d)}return this.o?this.o:this.o=t(this)};j.prototype.remove=function(a,b,c){if(a=n[a]?this.d["e-"+a]:this.d[a])for(var d=0;d<a.length;d++)if(a[d].c==b&&
a[d].f===c){r(a.splice(d,1)[0]);break}return this.j?this.j:this.j=s(this)};var v=function(){function a(a,d,b){this.h=a;this.c=d;this.add=p(this,this.e=b)}function b(a){this.b=[];this.a=a}a.prototype.destroy=function(){this.e.a.removeEventListener(this.h,this.k?this.k:this.c,g);delete this.c};a.prototype.destroyOnUse=function(){function a(){b.destroy();b.e.a.removeEventListener(b.h,a,g)}var b=this;b.e.a.addEventListener(b.h,a,g);return b};b.prototype.add=function(b,d,e){if(null===d)return this.i?this.i:
this.i=new m(this);var f=new a(b,d,this);if(!(void 0===e||this.a===e)){for(var h=0;h<this.b.length;h++)if(this.b[h].c==d&&this.b[h].h==b&&(f=this.b[h]).f===e)return f;d=f.k=q(d,f.f=e);this.b.push(f)}this.a.addEventListener(b,d,g);return f};b.prototype.remove=function(a,b,e){if(!(void 0===e||this.a===e))for(var f=0;f<this.b.length;f++)if(this.b[f].c==b&&this.b[f].h==a&&this.b[f].f===e){this.a.removeEventListener(a,this.b.splice(f,1)[0].k,g);break}this.a.removeEventListener(a,b,g);return this.j?this.j:
this.j=s(this)};return b}();o.EventEmitter=j;o.HTMLEventEmitter=v})(this);
