'use strict';(function(n){function o(){}function p(a,b){return function(d,c,e){return new k(a,(this==a?b:this).add(d,c,e))}}function i(a,b,d){this.g=void 0===(this.f=b)?this.c=a:(this.c=a).bind(b);this.add=p(this,this.e=d)}function q(a){delete a.c;delete a.g;delete a.f;a.destroy=o}function l(a){this.e=a}function k(a,b){this.l=a;this.m=b}function j(a){this.a=void 0===a?this:a;this.d={}}function s(a){var b={emit:function(){var d=this==b?a:this;return d.emit.apply(d,arguments)}};return b}function r(a){var b;
return b={remove:function(d,c,e){return(this==b?a:this).remove(d,c,e)}}}var g=!1,m={};i.prototype.destroy=function(){q(this.n.splice(this.n.lastIndexOf(this),1)[0])};i.prototype.destroyOnUse=function(){var a=this,b=this.g;this.g=function(){a.destroy();b.call(this)};return a};l.prototype={add:function(a,b,d){return this.e.add(a,b,d)},destroy:o,destroyOnUse:function(){return this}};k.prototype={add:function(a,b,d){return new k(this.l,this.m.add(a,b,d))},destroy:function(){this.l.destroy();this.m.destroy()},
destroyOnUse:function(){this.l.destroyOnUse();this.m.destroyOnUse();return this}};j.prototype.add=function(a,b,d){if(null===b)return this.i?this.i:this.i=new l(this);var c=m[a]?this.d[a="e-"+a]:this.d[a],e;if(c){for(a=0;a<c.length;a++)if(c[a].c==b&&(e=c[a]).f===d)return e;c.push(e=new i(b,d,this))}else c=this.d[a]=[e=new i(b,d,this)];e.n=c;return e};j.prototype.emit=function(a,b){var d=m[a]?this.d[a="e-"+a]:this.d[a];if(d){var c=1==arguments.length?[]:d.slice.call(arguments,1);if(1==d.length)d[0].g.apply(this.a,
c);else if(d.length)for(var d=d.slice(0),e=0;e<d.length;e++)d[e].g.apply(this.a,c)}return this.o?this.o:this.o=s(this)};j.prototype.remove=function(a,b,d){if(a=m[a]?this.d["e-"+a]:this.d[a])for(var c=0;c<a.length;c++)if(a[c].c==b&&a[c].f===d){q(a.splice(c,1)[0]);break}return this.j?this.j:this.j=r(this)};var t=function(){function a(a,c,b){this.h=a;this.c=c;this.add=p(this,this.e=b)}function b(a){this.b=[];this.a=a}a.prototype.destroy=function(){this.e.a.removeEventListener(this.h,this.k?this.k:this.c,
g);delete this.c};a.prototype.destroyOnUse=function(){function a(){c.destroy();c.e.a.removeEventListener(c.h,a,g)}var c=this;c.e.a.addEventListener(c.h,a,g);return c};b.prototype.add=function(d,c,b){if(null===c)return this.i?this.i:this.i=new l(this);var f=new a(d,c,this);if(!(void 0===b||this.a===b)){for(var h=0;h<this.b.length;h++)if(this.b[h].c==c&&this.b[h].h==d&&(f=this.b[h]).f===b)return f;c=f.k=c.bind(f.f=b);this.b.push(f)}this.a.addEventListener(d,c,g);return f};b.prototype.remove=function(a,
c,b){if(!(void 0===b||this.a===b))for(var f=0;f<this.b.length;f++)if(this.b[f].c==c&&this.b[f].h==a&&this.b[f].f===b){this.a.removeEventListener(a,this.b.splice(f,1)[0].k,g);break}this.a.removeEventListener(a,c,g);return this.j?this.j:this.j=r(this)};return b}();n.EventEmitter=j;n.HTMLEventEmitter=t})(this);
