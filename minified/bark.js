'use strict';(function(m){function n(){}function g(a,b,d){this.f=void 0===(this.j=b)?this.c=a:(this.c=a).bind(b);this.e=d}function o(a){delete a.c;delete a.f;delete a.j;a.destroy=n}function j(a){this.e=a}function k(a,b){this.l=a;this.m=b}function i(a){this.a=void 0===a?this:a;this.d={}}var h=!1,l={};g.prototype.add=function(a,b,d){return new k(this,this.e.add(a,b,d))};g.prototype.destroy=function(){o(this.n.splice(this.n.lastIndexOf(this),1)[0])};g.prototype.destroyOnUse=function(){var a=this,b=this.f;
this.f=function(){a.destroy();b.call(this)};return a};j.prototype={add:function(a,b,d){return this.e.add(a,b,d)},destroy:n,destroyOnUse:function(){return this}};k.prototype={add:function(a,b,d){return new k(this.l,this.m.add(a,b,d))},destroy:function(){this.l.destroy();this.m.destroy()},destroyOnUse:function(){this.l.destroyOnUse();this.m.destroyOnUse();return this}};i.prototype.add=function(a,b,d){if(null===b)return this.h?this.h:this.h=new j(this);var c=l[a]?this.d[a="e-"+a]:this.d[a],e;if(c){for(a=
0;a<c.length;a++)if(c[a].c==b&&(e=c[a]).j===d)return e;c.push(e=new g(b,d,this))}else c=this.d[a]=[e=new g(b,d,this)];e.n=c;return e};i.prototype.emit=function(a){var b=l[a]?this.d[a="e-"+a]:this.d[a];if(b){var d=1==arguments.length?[]:b.slice.call(arguments,1);if(1==b.length)b[0].f.apply(this.a,d);else if(b.length)for(var b=b.slice(0),c=0;c<b.length;c++)b[c].f.apply(this.a,d)}return this.o?this.o:this.o={emit:this.emit.bind(this)}};i.prototype.remove=function(a,b,d){if(a=l[a]?this.d["e-"+a]:this.d[a])for(var c=
0;c<a.length;c++)if(a[c].c==b&&a[c].j===d){o(a.splice(c,1)[0]);break}return this.i?this.i:this.i={remove:this.remove.bind(this)}};var p=function(){function a(a,c,b){this.g=a;this.c=c;this.e=b}function b(a){this.b=[];this.a=a}a.prototype.add=g.prototype.add;a.prototype.destroy=function(){this.e.a.removeEventListener(this.g,this.k?this.k:this.c,h);delete this.c};a.prototype.destroyOnUse=function(){function a(){c.destroy();c.e.a.removeEventListener(c.g,a,h)}var c=this;c.e.a.addEventListener(c.g,a,h);
return c};b.prototype.add=function(b,c,e){if(null===c)return this.h?this.h:this.h=new j(this);var f=new a(b,c,this);if(!(void 0===e||this.a===e)){for(var g=0;g<this.b.length;g++)if(this.b[g].c==c&&this.b[g].g==b&&(f=this.b[g]).j===e)return f;c=f.k=c.bind(f.scope=e);this.b.push(f)}this.a.addEventListener(b,c,h);return f};b.prototype.remove=function(a,b,e){if(!(void 0===e||this.a===e))for(var f=0;f<this.b.length;f++)if(this.b[f].c==b&&this.b[f].g==a&&this.b[f].scope===e){this.a.removeEventListener(a,
this.b.splice(f,1)[0].k,h);break}this.a.removeEventListener(a,b,h);return this.i?this.i:this.i={remove:this.remove.bind(this)}};return b}();m.EventEmitter=i;m.HTMLEventEmitter=p})(this);
