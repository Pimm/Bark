'use strict';(function(l){function i(){}function f(a,b,c){this.b=null===(this.h=b)?this.d=a:(this.d=a).bind(b);this.f=c}function j(a){delete a.d;delete a.b;delete a.h;a.destroy=i}function k(a){this.f=a}function g(a,b){this.g=a;this.i=b}function e(a){this.a={};this.e=void 0===a?this:a}var h={};f.prototype.add=function(a,b,c){return new g(this,this.f.add(a,b,c))};f.prototype.destroy=function(){j(this.j.splice(this.j.lastIndexOf(this),1)[0])};f.prototype.destroyOnUse=function(){var a=this,b=this.b;this.b=
function(){a.destroy();b.call(this)};return a};k.prototype={add:function(a,b,c){return this.f.add(a,b,c)},destroy:i,destroyOnUse:function(){return this}};g.prototype={add:function(a,b,c){return new g(this.g,this.i.add(a,b,c))},destroy:function(){this.g.destroy();this.i.destroy()},destroyOnUse:function(){this.g.destroyOnUse();this.i.destroyOnUse();return this}};e.prototype.add=function(a,b,c){if(null===b)return this.l?this.l:this.l=new k(this);void 0===c&&(c=this===this.e?null:this.e);var d=h[a]?this.a[a=
"event-type-"+a]:this.a[a];if(d){for(var e=0;e<d.length;e++)if(d[e].d==b&&(a=d[e],a.h===c))return a;d.push(a=new f(b,c,this))}else d=this.a[a]=[a=new f(b,c,this)];a.j=d;return a};e.prototype.emit=function(a){if(a=h[a]?this.a["event-type-"+a]:this.a[a]){if(1==a.length)this.c=a[0].b,this.c();else if(a.length)for(var a=a.slice(0),b=0;b<a.length;b++)this.c=a[b].b,this.c();delete this.c}return this.k?this.k:this.k={emit:this.emit.bind(this)}};e.prototype.remove=function(a,b,c){void 0===c&&(c=this==this.e?
null:this.e);if(a=h[a]?this.a["event-type-"+a]:this.a[a])for(var d=0;d<a.length;d++)if(a[d].d==b&&a[d].h===c){j(a.splice(d,1)[0]);break}return this.m?this.m:this.m={remove:this.remove.bind(this)}};l.EventEmitter=e})(this);
