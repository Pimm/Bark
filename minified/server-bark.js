'use strict';(function(m){function j(){}function f(a,b,d){this.b=void 0===(this.f=b)?this.c=a:(this.c=a).bind(b);this.d=d}function k(a){delete a.c;delete a.b;delete a.f;a.destroy=j}function l(a){this.d=a}function h(a,b){this.e=a;this.g=b}function g(a){this.l=void 0===a?this:a;this.a={}}var i={};f.prototype.add=function(a,b,d){return new h(this,this.d.add(a,b,d))};f.prototype.destroy=function(){k(this.h.splice(this.h.lastIndexOf(this),1)[0])};f.prototype.destroyOnUse=function(){var a=this,b=this.b;
this.b=function(){a.destroy();b.call(this)};return a};l.prototype={add:function(a,b,d){return this.d.add(a,b,d)},destroy:j,destroyOnUse:function(){return this}};h.prototype={add:function(a,b,d){return new h(this.e,this.g.add(a,b,d))},destroy:function(){this.e.destroy();this.g.destroy()},destroyOnUse:function(){this.e.destroyOnUse();this.g.destroyOnUse();return this}};g.prototype.add=function(a,b,d){if(null===b)return this.j?this.j:this.j=new l(this);var c=i[a]?this.a[a="e-"+a]:this.a[a],e;if(c){for(a=
0;a<c.length;a++)if(c[a].c==b&&(e=c[a]).f===d)return e;c.push(e=new f(b,d,this))}else c=this.a[a]=[e=new f(b,d,this)];e.h=c;return e};g.prototype.emit=function(a){var b=i[a]?this.a[a="e-"+a]:this.a[a];if(b){var d=1==arguments.length?[]:b.slice.call(arguments,1);if(1==b.length)b[0].b.apply(this.l,d);else if(b.length)for(var b=b.slice(0),c=0;c<b.length;c++)b[c].b.apply(this.l,d)}return this.i?this.i:this.i={emit:this.emit.bind(this)}};g.prototype.remove=function(a,b,d){if(a=i[a]?this.a["e-"+a]:this.a[a])for(var c=
0;c<a.length;c++)if(a[c].c==b&&a[c].f===d){k(a.splice(c,1)[0]);break}return this.k?this.k:this.k={remove:this.remove.bind(this)}};m.EventEmitter=g})(this);
