'use strict';(function(m){function j(){}function n(a,c){return function(b,d,e){return new h(a,(this==a?c:this).add(b,d,e))}}function f(a,c,b){this.b=void 0===(this.e=c)?this.c=a:(this.c=a).bind(c);this.add=n(this,this.i=b)}function k(a){delete a.c;delete a.b;delete a.e;a.destroy=j}function l(a){this.i=a}function h(a,c){this.d=a;this.f=c}function g(a){this.l=void 0===a?this:a;this.a={}}function o(a){var c={emit:function(){var b=this==c?a:this;return b.emit.apply(b,arguments)}};return c}function p(a){var c;
return c={remove:function(b,d,e){return(this==c?a:this).remove(b,d,e)}}}var i={};f.prototype.destroy=function(){k(this.g.splice(this.g.lastIndexOf(this),1)[0])};f.prototype.destroyOnUse=function(){var a=this,c=this.b;this.b=function(){a.destroy();c.call(this)};return a};l.prototype={add:function(a,c,b){return this.i.add(a,c,b)},destroy:j,destroyOnUse:function(){return this}};h.prototype={add:function(a,c,b){return new h(this.d,this.f.add(a,c,b))},destroy:function(){this.d.destroy();this.f.destroy()},
destroyOnUse:function(){this.d.destroyOnUse();this.f.destroyOnUse();return this}};g.prototype.add=function(a,c,b){if(null===c)return this.j?this.j:this.j=new l(this);var d=i[a]?this.a[a="e-"+a]:this.a[a],e;if(d){for(a=0;a<d.length;a++)if(d[a].c==c&&(e=d[a]).e===b)return e;d.push(e=new f(c,b,this))}else d=this.a[a]=[e=new f(c,b,this)];e.g=d;return e};g.prototype.emit=function(a,c){var b=i[a]?this.a[a="e-"+a]:this.a[a];if(b){var d=1==arguments.length?[]:b.slice.call(arguments,1);if(1==b.length)b[0].b.apply(this.l,
d);else if(b.length)for(var b=b.slice(0),e=0;e<b.length;e++)b[e].b.apply(this.l,d)}return this.h?this.h:this.h=o(this)};g.prototype.remove=function(a,c,b){if(a=i[a]?this.a["e-"+a]:this.a[a])for(var d=0;d<a.length;d++)if(a[d].c==c&&a[d].e===b){k(a.splice(d,1)[0]);break}return this.k?this.k:this.k=p(this)};m.EventEmitter=g})(this);
